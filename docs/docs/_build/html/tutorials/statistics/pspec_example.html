<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Spatial Power Spectrum &#8212; turbustat v1.0.dev2395</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Spectral Correlation Function (SCF)" href="scf_example.html" />
    <link rel="prev" title="PDF" href="pdf_example.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          turbustat</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.dev2395</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing TurbuStat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accepted_input_formats.html">Accepted Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preparing_simulated_data.html">Preparing Simulated Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_requirements.html">Data Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../moments.html">Deriving Cube Moments</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">TurbuStat Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generating_test_data.html">Creating testing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html#distance-metrics">Distance Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to TurbuStat</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Spatial Power Spectrum</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="pdf_example.html" title="Previous Chapter: PDF"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; PDF</span>
    </a>
  </li>
  <li>
    <a href="scf_example.html" title="Next Chapter: Spectral Correlation Function (SCF)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Spectral Corr... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/tutorials/statistics/pspec_example.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Spatial Power Spectrum</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="spatial-power-spectrum">
<span id="pspec-tutorial"></span><h1>Spatial Power Spectrum<a class="headerlink" href="#spatial-power-spectrum" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>A common analysis technique for two-dimensional images is the spatial power spectrum – the square of the 2D Fourier transform of an image. A radial profile of the 2D power spectrum gives the 1D power spectrum. The slope of this 1D spectrum can be compared to the expected indices in different physical limits. For example, the velocity field of Kolmogorov turbulence follows <span class="math notranslate nohighlight">\(k^{-5/3}\)</span>, while Burgers’ turbulence has <span class="math notranslate nohighlight">\(k^{-2}\)</span>.</p>
<p>However, observations are a combination of both velocity and density fluctuations (e.g., <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2000ApJ...537..720L/abstract">Lazarian &amp; Pogosyan 2000</a>), and the measured index from an integrated intensity map depend on both components, as well as optical depth effects. For a turbulent optically thin tracer, an integrated intensity image (or zeroth moment) will have <span class="math notranslate nohighlight">\(k^{-11/3}\)</span>, while an optically thick tracer saturates to <span class="math notranslate nohighlight">\(k^{-3}\)</span> (<a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2004ApJ...616..943L/abstract">Lazarian &amp; Pogosyan 2004</a>, <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2013ApJ...771..123B/abstract">Burkhart et al. 2013</a>). The effect of velocity resolution is discussed in the <a class="reference internal" href="vca_example.html#vca-tutorial"><span class="std std-ref">VCA tutorial</span></a>.</p>
</div>
<div class="section" id="using">
<h2>Using<a class="headerlink" href="#using" title="Permalink to this headline">¶</a></h2>
<p><strong>The data in this tutorial are available</strong> <a class="reference external" href="https://girder.hub.yt/#user/57b31aee7b6f080001528c6d/folder/59721a30cc387500017dbe37">here</a>.</p>
<p>We need to import the <a class="reference internal" href="../../api/turbustat.statistics.PowerSpectrum.html#turbustat.statistics.PowerSpectrum" title="turbustat.statistics.PowerSpectrum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PowerSpectrum</span></code></a> code, along with a few other common packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">turbustat.statistics</span> <span class="k">import</span> <span class="n">PowerSpectrum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
</pre></div>
</div>
<p>And we load in the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moment0</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Design4_flatrho_0021_00_radmc_moment0.fits&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>The power spectrum is computed using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pspec</span> <span class="o">=</span> <span class="n">PowerSpectrum</span><span class="p">(</span><span class="n">moment0</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">250</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pspec</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.941</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.941</span>
<span class="go">Method:                 Least Squares   F-statistic:                     1426.</span>
<span class="go">Date:                Fri, 29 Sep 2017   Prob (F-statistic):           1.44e-56</span>
<span class="go">Time:                        14:32:47   Log-Likelihood:                -52.829</span>
<span class="go">No. Observations:                  91   AIC:                             109.7</span>
<span class="go">Df Residuals:                      89   BIC:                             114.7</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          3.1677      0.103     30.828      0.000       2.964       3.372</span>
<span class="go">x1            -5.0144      0.133    -37.761      0.000      -5.278      -4.751</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        3.532   Durbin-Watson:                   0.129</span>
<span class="go">Prob(Omnibus):                  0.171   Jarque-Bera (JB):                3.481</span>
<span class="go">Skew:                          -0.468   Prob(JB):                        0.175</span>
<span class="go">Kurtosis:                       2.797   Cond. No.                         4.40</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_pspec.png" src="../../_images/design4_pspec.png" />
<p>The code returns a summary of the one-dimensional fit and a figure showing the one-dimensional spectrum and model on the left, and the two-dimensional power-spectrum on the right. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_2D=True</span></code> is set in <a class="reference internal" href="../../api/turbustat.statistics.PowerSpectrum.html#turbustat.statistics.PowerSpectrum.run" title="turbustat.statistics.PowerSpectrum.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> (the default setting), the contours on the two-dimensional power-spectrum are fit using an elliptical power-law model. We will discuss the models in more detail below. The dashed red lines (or contours) on both plots are the limits of the data used in the fits.</p>
<p>The power spectrum of this simulation has a slope of <span class="math notranslate nohighlight">\(-3.3\pm0.1\)</span>, but the power-spectrum deviates from a single power-law on small scales. This is due to the the <a class="reference internal" href="../data_for_tutorials.html#data-for-tutorial"><span class="std std-ref">limited inertial range in this simulation</span></a>. The spatial frequencies used in the fit can be limited by setting <code class="xref py py-obj docutils literal notranslate"><span class="pre">low_cut</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">high_cut</span></code>. The inputs should have frequency units in pixels, angle, or physical units. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pspec</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span> <span class="n">low_cut</span><span class="o">=</span><span class="mf">0.025</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">high_cut</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.971</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.968</span>
<span class="go">Method:                 Least Squares   F-statistic:                     398.6</span>
<span class="go">Date:                Thu, 28 Sep 2017   Prob (F-statistic):           1.42e-10</span>
<span class="go">Time:                        17:02:20   Log-Likelihood:                 14.077</span>
<span class="go">No. Observations:                  14   AIC:                            -24.15</span>
<span class="go">Df Residuals:                      12   BIC:                            -22.87</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          5.5109      0.190     29.021      0.000       5.097       5.925</span>
<span class="go">x1            -3.0223      0.151    -19.964      0.000      -3.352      -2.692</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        0.901   Durbin-Watson:                   2.407</span>
<span class="go">Prob(Omnibus):                  0.637   Jarque-Bera (JB):                0.718</span>
<span class="go">Skew:                          -0.215   Prob(JB):                        0.698</span>
<span class="go">Kurtosis:                       1.977   Cond. No.                         15.2</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_pspec_limitedfreq.png" src="../../_images/design4_pspec_limitedfreq.png" />
<p>When limiting the fit to the inertial range, the slope is <span class="math notranslate nohighlight">\(-3.0\pm0.2\)</span>. <code class="xref py py-obj docutils literal notranslate"><span class="pre">low_cut</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">high_cut</span></code> can also be given as spatial frequencies in angular units (e.g., <code class="xref py py-obj docutils literal notranslate"><span class="pre">u.deg**-1</span></code>). And since a distance was specified, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">low_cut</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">high_cut</span></code> can also be given in physical frequency units (e.g., <code class="xref py py-obj docutils literal notranslate"><span class="pre">u.pc**-1</span></code>).</p>
<p>The fit to the two-dimensional power-spectrum has also changed. These parameters aren’t included in the fit summary for the 1D fit. Instead, they can be accessed through:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pspec</span><span class="o">.</span><span class="n">slope2D</span><span class="p">,</span> <span class="n">pspec</span><span class="o">.</span><span class="n">slope2D_err</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">(-3.155235947194412, 0.19744198375014044)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pspec</span><span class="o">.</span><span class="n">ellip2D</span><span class="p">,</span> <span class="n">pspec</span><span class="o">.</span><span class="n">ellip2D_err</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">(0.74395734515060385, 0.043557506230624203)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pspec</span><span class="o">.</span><span class="n">theta2D</span><span class="p">,</span> <span class="n">pspec</span><span class="o">.</span><span class="n">theta2D_err</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">(1.1364954648370515, 0.09436799399259721)</span>
</pre></div>
</div>
<p>The slope is moderately steeper than in the 1D model, but within the respective uncertainty ranges. By default, the parameter uncertainties for the 2D model are determined by a bootstrap. After fitting the model, the residuals are resampled and added back to the data. The resampled data are then fit to the model. This procedure is repeated some number of times (the default is 100) to build up distributions for the fit parameters. The bootstrap estimation is enabled in the code by setting the <code class="xref py py-obj docutils literal notranslate"><span class="pre">bootstrap</span></code> keyword to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> in <a class="reference internal" href="../../api/turbustat.statistics.PowerSpectrum.html#turbustat.statistics.PowerSpectrum.fit_2Dpspec" title="turbustat.statistics.PowerSpectrum.fit_2Dpspec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_2Dpspec</span></code></a> and the number of iterations is set with <code class="xref py py-obj docutils literal notranslate"><span class="pre">niters</span></code> (the default is 100). These can be set in <a class="reference internal" href="../../api/turbustat.statistics.PowerSpectrum.html#turbustat.statistics.PowerSpectrum.run" title="turbustat.statistics.PowerSpectrum.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> by passing a keyword dictionary to <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_2D_kwargs</span></code> (e.g., <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_2D_kwargs={'bootstrap':</span> <span class="pre">False}</span></code>). The other parameters are the ellipticity, which is bounded between 0 and 1 (with 1 being circular), and theta, the angle between the x-axis and the semi-major axis of the ellipse. Theta is bounded between 0 and <span class="math notranslate nohighlight">\(\pi\)</span>. The 2D power spectrum here is moderately anisotropic.</p>
<p>Breaks in the power-law behaviour in observations (and higher-resolution simulations) can result from differences in the physical processes dominating at those scales (e.g., <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2008ApJS..174..202S/abstract">Swift &amp; Welch 2008</a>). To capture this behaviour, <code class="xref py py-obj docutils literal notranslate"><span class="pre">PowerSpectrum</span></code> can be passed a break point to enable fitting with a segmented linear model (<a class="reference internal" href="../../api/turbustat.statistics.Lm_Seg.html#turbustat.statistics.Lm_Seg" title="turbustat.statistics.Lm_Seg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Lm_Seg</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pspec</span> <span class="o">=</span> <span class="n">PowerSpectrum</span><span class="p">(</span><span class="n">moment0</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">250</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pspec</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span> <span class="n">low_cut</span><span class="o">=</span><span class="mf">0.02</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="n">high_cut</span><span class="o">=</span><span class="mf">0.4</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">fit_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;brk&#39;</span><span class="p">:</span> <span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="s1">&#39;log_break&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="n">fit_2D</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.996</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.995</span>
<span class="go">Method:                 Least Squares   F-statistic:                     4904.</span>
<span class="go">Date:                Fri, 29 Sep 2017   Prob (F-statistic):           1.84e-77</span>
<span class="go">Time:                        14:29:10   Log-Likelihood:                 61.421</span>
<span class="go">No. Observations:                  70   AIC:                            -114.8</span>
<span class="go">Df Residuals:                      66   BIC:                            -105.8</span>
<span class="go">Df Model:                           3</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          5.1169      0.087     59.057      0.000       4.944       5.290</span>
<span class="go">x1            -3.3384      0.082    -40.924      0.000      -3.501      -3.176</span>
<span class="go">x2            -4.9624      0.191    -26.043      0.000      -5.343      -4.582</span>
<span class="go">x3            -0.0084      0.048     -0.174      0.863      -0.105       0.088</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        3.812   Durbin-Watson:                   1.096</span>
<span class="go">Prob(Omnibus):                  0.149   Jarque-Bera (JB):                2.211</span>
<span class="go">Skew:                          -0.191   Prob(JB):                        0.331</span>
<span class="go">Kurtosis:                       2.218   Cond. No.                         22.4</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_pspec_breakfit.png" src="../../_images/design4_pspec_breakfit.png" />
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">brk</span></code> is the initial guess fpr where the break point location is. Here I’ve set it to the extent of the inertial range of the simulation. <code class="xref py py-obj docutils literal notranslate"><span class="pre">log_break</span></code> should be enabled if the given <code class="xref py py-obj docutils literal notranslate"><span class="pre">brk</span></code> is already the log (base-10) value (since the fitting is done in log-space). The segmented linear model iteratively optimizes the location of the break point, trying to minimize the gap between the different components. This is the <code class="xref py py-obj docutils literal notranslate"><span class="pre">x3</span></code> parameter above. The slopes of the components are <code class="xref py py-obj docutils literal notranslate"><span class="pre">x1</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x2</span></code>, but the second slope is defined <em>relative to the first slope</em> (i.e., if <code class="xref py py-obj docutils literal notranslate"><span class="pre">x2=0</span></code>, the slopes of the components would be the same). The true slopes can be accessed through <code class="xref py py-obj docutils literal notranslate"><span class="pre">pspec.slope</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">pspec.slope_err</span></code>. The location of the fitted break point is given by <code class="xref py py-obj docutils literal notranslate"><span class="pre">pspec.brk</span></code>, and its uncertainty <code class="xref py py-obj docutils literal notranslate"><span class="pre">pspec.brk_err</span></code>. If the fit does not find a good break point, it will revert to a linear fit without the break.</p>
<p>Note that the 2D fitting was disabled in this last example. The 2D model cannot fit a break point, and will instead try to fit a single power-law for the between <code class="xref py py-obj docutils literal notranslate"><span class="pre">low_cut</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">high_cut</span></code>, which we know already know is the wrong model. Thus, it has been disabled to avoid confusion. A strategy for fitting the 2D model when the spectrum shows a break is to first fit the 1D model, find the break point, and then fit the 2D spectrum independently using the break point as the <code class="xref py py-obj docutils literal notranslate"><span class="pre">high_cut</span></code> in <a class="reference internal" href="../../api/turbustat.statistics.PowerSpectrum.html#turbustat.statistics.PowerSpectrum.fit_2Dpspec" title="turbustat.statistics.PowerSpectrum.fit_2Dpspec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_2Dpspec</span></code></a>.</p>
<p>There may be cases where you want to limit the azimuthal angles used to create the 1D averaged power-spectrum. This may be useful if, for example, you want to find a measure of anistropy but the 2D power-law fit is not performing well. We will add extra constraints to the previous example with a break point:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pspec</span> <span class="o">=</span> <span class="n">PowerSpectrum</span><span class="p">(</span><span class="n">moment0</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">250</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pspec</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span> <span class="n">low_cut</span><span class="o">=</span><span class="mf">0.02</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="n">high_cut</span><span class="o">=</span><span class="mf">0.4</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">fit_2D</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fit_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;brk&#39;</span><span class="p">:</span> <span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="s1">&#39;log_break&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
<span class="gp">... </span>          <span class="n">radial_pspec_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;theta_0&quot;</span><span class="p">:</span> <span class="mf">1.13</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span> <span class="s2">&quot;delta_theta&quot;</span><span class="p">:</span> <span class="mi">40</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">})</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.990</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.989</span>
<span class="go">Method:                 Least Squares   F-statistic:                     2113.</span>
<span class="go">Date:                Fri, 29 Sep 2017   Prob (F-statistic):           1.76e-65</span>
<span class="go">Time:                        14:29:10   Log-Likelihood:                 30.377</span>
<span class="go">No. Observations:                  70   AIC:                            -52.75</span>
<span class="go">Df Residuals:                      66   BIC:                            -43.76</span>
<span class="go">Df Model:                           3</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          5.7150      0.173     33.005      0.000       5.369       6.061</span>
<span class="go">x1            -2.9371      0.154    -19.041      0.000      -3.245      -2.629</span>
<span class="go">x2            -4.9096      0.254    -19.313      0.000      -5.417      -4.402</span>
<span class="go">x3             0.0156      0.077      0.202      0.840      -0.138       0.169</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        3.679   Durbin-Watson:                   1.837</span>
<span class="go">Prob(Omnibus):                  0.159   Jarque-Bera (JB):                1.894</span>
<span class="go">Skew:                          -0.030   Prob(JB):                        0.388</span>
<span class="go">Kurtosis:                       2.196   Cond. No.                         22.9</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_pspec_breakfit_azimlimits.png" src="../../_images/design4_pspec_breakfit_azimlimits.png" />
<p>The azimuthal mask has been added onto the plot of the two-dimensional power spectrum. The constraints used here are based on the major axis direction from the two-dimensional fit performed above. This is given as <code class="xref py py-obj docutils literal notranslate"><span class="pre">theta_0</span></code>. The other parameter, <code class="xref py py-obj docutils literal notranslate"><span class="pre">delta_theta</span></code>, is the width of the azimuthal mask to use. Both parameters can be specified in any angular unit.</p>
<p>The default fit uses Ordinary Least Squares. A Weighted Least Squares can be enabled with <code class="xref py py-obj docutils literal notranslate"><span class="pre">weighted_fit=True</span></code> <em>if</em> the segmented linear fit is not used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pspec</span> <span class="o">=</span> <span class="n">PowerSpectrum</span><span class="p">(</span><span class="n">moment0</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">250</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pspec</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span> <span class="n">low_cut</span><span class="o">=</span><span class="mf">0.025</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="n">high_cut</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">fit_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weighted_fit&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            WLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.969</span>
<span class="go">Model:                            WLS   Adj. R-squared:                  0.966</span>
<span class="go">Method:                 Least Squares   F-statistic:                     372.0</span>
<span class="go">Date:                Fri, 29 Sep 2017   Prob (F-statistic):           2.13e-10</span>
<span class="go">Time:                        15:08:21   Log-Likelihood:                 13.966</span>
<span class="go">No. Observations:                  14   AIC:                            -23.93</span>
<span class="go">Df Residuals:                      12   BIC:                            -22.65</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          5.5119      0.194     28.476      0.000       5.090       5.934</span>
<span class="go">x1            -3.0200      0.157    -19.288      0.000      -3.361      -2.679</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        0.701   Durbin-Watson:                   2.387</span>
<span class="go">Prob(Omnibus):                  0.704   Jarque-Bera (JB):                0.655</span>
<span class="go">Skew:                          -0.235   Prob(JB):                        0.721</span>
<span class="go">Kurtosis:                       2.050   Cond. No.                         15.3</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_pspec_limitedfreq_weightfit.png" src="../../_images/design4_pspec_limitedfreq_weightfit.png" />
<p>The fit has not changed significantly but may in certain cases.</p>
<p>If strong emission continues to the edge of the map (and the map does not have periodic boundaries), ringing in the FFT can introduce a cross pattern in the 2D power-spectrum. This effect and the use of apodizing kernels to taper the data is covered <a class="reference internal" href="../applying_apodizing_functions.html#apodkerns"><span class="std std-ref">here</span></a>.</p>
<p>Most observational data will be smoothed over the beam size, which will steepen the power spectrum on small scales.  To account for this, the 2D power spectrum can be divided by the beam response. This is demonstrated <a class="reference internal" href="../correcting_for_the_beam.html#correcting-for-beam"><span class="std std-ref">here</span></a> for spatial power-spectra.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Many papers have utilized the power spectrum. An incomplete list is provided below:</p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1983A&amp;A...122..282C/abstract">Crovisier &amp; Dickey 1983</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1984ApJ...277..556S/abstract">Scalo 1984</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1993MNRAS.262..327G/abstract">Green 1993</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1998ApJ...500..525S/abstract">Schlegel et al. 1998</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2000ApJ...537..720L/abstract">Lazarian &amp; Pogosyan 2000</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2001ApJ...548..749E/abstract">Elmegreen et al. 2001</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2001ApJ...551L..53S/abstract">Stanimirovic &amp; Lazarian 2001</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2003A&amp;A...411..109M/abstract">Miville-Deschenes et al. 2003</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2004ApJ...616..943L/abstract">Lazarian &amp; Pogosyan 2004</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2005ApJ...631..320E/abstract">Esquivel et al. 2005</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2008ApJS..174..202S/abstract">Swift &amp; Welch 2008</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2010A&amp;A...518L.104M/abstract">Miville-Deschenes et al. 2010</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2012ApJ...754...29Z/abstract">Zhang et al. 2012</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2013ApJ...771..123B/abstract">Burkhart et al. 2013</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2015ApJ...809..153M/abstract">Martin et al. 2015</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2015MNRAS.446.3777B/abstract">Bertram et al. 2015</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2016A&amp;A...595A..37K/abstract">Kalberla et al. 2016</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2017MNRAS.464.3617K/abstract">Kandel et al. 2017</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, TurbuStat Development Team.<br/>
      Last updated on 13 Feb 2019.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>