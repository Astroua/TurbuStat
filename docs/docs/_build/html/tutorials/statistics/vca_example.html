<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Velocity Channel Analysis (VCA) &#8212; turbustat v1.0.dev2397</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Velocity Coordinate Spectrum (VCS)" href="vcs_example.html" />
    <link rel="prev" title="Tsallis Statistics" href="tsallis_example.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          turbustat</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.dev2397</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing TurbuStat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accepted_input_formats.html">Accepted Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preparing_simulated_data.html">Preparing Simulated Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_requirements.html">Data Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../moments.html">Deriving Cube Moments</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">TurbuStat Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generating_test_data.html">Creating testing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html#distance-metrics">Distance Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to TurbuStat</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Velocity Channel Analysis (VCA)</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="tsallis_example.html" title="Previous Chapter: Tsallis Statistics"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Tsallis Statistics</span>
    </a>
  </li>
  <li>
    <a href="vcs_example.html" title="Next Chapter: Velocity Coordinate Spectrum (VCS)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Velocity Coor... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/tutorials/statistics/vca_example.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Velocity Channel Analysis (VCA)</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="velocity-channel-analysis-vca">
<span id="vca-tutorial"></span><h1>Velocity Channel Analysis (VCA)<a class="headerlink" href="#velocity-channel-analysis-vca" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>A major advantage of a spectral-line data cube, rather than an integrated two-dimensional image, is that it captures aspects of both the density and velocity fluctuations in the field of observation. <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2000ApJ...537..720L/abstract">Lazarian &amp; Pogosyan 2000</a> and <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2004ApJ...616..943L/abstract">Lazarian &amp; Pogosyan 2004</a> derived how the power spectrum from a cube depends on the statistics of the density and velocity fields for the 21-cm Hydrogen line, allowing for each of their properties to be examined (provided the data have sufficient spectral resolution).</p>
<p>The Lazarian &amp; Pogosyan theory predicts two regimes based on the the power-spectrum slope: the <em>shallow</em> (<span class="math notranslate nohighlight">\(n &lt; -3\)</span>) and the <em>steep</em> (<span class="math notranslate nohighlight">\(n &lt; -3\)</span>) regimes. In the case of optically thick line emission, <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2004ApJ...616..943L/abstract">Lazarian &amp; Pogosyan 2004</a> show that the slope saturates to <span class="math notranslate nohighlight">\(n = -3\)</span> (see <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2013ApJ...771..123B/abstract">Burkhart et al. 2013</a> as well). The VCA predictions in these different regimes are shown in Table 1 of <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2009ApJ...693.1074C/abstract">Chepurnov &amp; Lazarian 2009</a> (also see Table 3 in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2009SSRv..143..357L/abstract">Lazarian 2009</a>). The complementary <a class="reference internal" href="#vca-tutorial"><span class="std std-ref">Velocity Coordinate Spectrum</span></a> can be used in tandem with VCA.</p>
</div>
<div class="section" id="using">
<h2>Using<a class="headerlink" href="#using" title="Permalink to this headline">¶</a></h2>
<p><strong>The data in this tutorial are available</strong> <a class="reference external" href="https://girder.hub.yt/#user/57b31aee7b6f080001528c6d/folder/59721a30cc387500017dbe37">here</a>.</p>
<p>We need to import the <a class="reference internal" href="../../api/turbustat.statistics.VCA.html#turbustat.statistics.VCA" title="turbustat.statistics.VCA"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VCA</span></code></a> class, along with a few other common packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">turbustat.statistics</span> <span class="k">import</span> <span class="n">VCA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
</pre></div>
</div>
<p>And we load in the data cube:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Design4_flatrho_0021_00_radmc.fits&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>The VCA spectrum is computed using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span> <span class="o">=</span> <span class="n">VCA</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.973</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.973</span>
<span class="go">Method:                 Least Squares   F-statistic:                     3188.</span>
<span class="go">Date:                Thu, 20 Jul 2017   Prob (F-statistic):           1.75e-71</span>
<span class="go">Time:                        15:14:32   Log-Likelihood:                -1.2719</span>
<span class="go">No. Observations:                  91   AIC:                             6.544</span>
<span class="go">Df Residuals:                      89   BIC:                             11.57</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          2.3928      0.058     41.036      0.000       2.277       2.509</span>
<span class="go">x1            -4.2546      0.075    -56.459      0.000      -4.404      -4.105</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        4.747   Durbin-Watson:                   0.069</span>
<span class="go">Prob(Omnibus):                  0.093   Jarque-Bera (JB):                4.622</span>
<span class="go">Skew:                          -0.550   Prob(JB):                       0.0992</span>
<span class="go">Kurtosis:                       2.916   Cond. No.                         4.40</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_vca.png" src="../../_images/design4_vca.png" />
<p>The code returns a summary of the one-dimensional fit and a figure showing the one-dimensional spectrum and model on the left, and the two-dimensional power-spectrum on the right. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_2D=True</span></code> is set in <a class="reference internal" href="../../api/turbustat.statistics.VCA.html#turbustat.statistics.VCA.run" title="turbustat.statistics.VCA.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> (the default setting), the contours on the two-dimensional power-spectrum are the fit using an elliptical power-law model. We will discuss the models in more detail below. The dashed red lines (or contours) on both plots are the limits of the data used in the fits. See the <a class="reference internal" href="pspec_example.html#pspec-tutorial"><span class="std std-ref">PowerSpectrum tutorial</span></a> for a discussion of the two-dimensional fitting.</p>
<p>The VCA power spectrum from this simulated data cube is <span class="math notranslate nohighlight">\(-4.25\pm0.08\)</span>, which is steeper than the power spectrum we found using the zeroth moment (<a class="reference internal" href="pspec_example.html#pspec-tutorial"><span class="std std-ref">PowerSpectrum tutorial</span></a>). However, as was the case for the power-spectrum of the zeroth moment, there are deviations from a single power-law on small scales due to the <a class="reference internal" href="../data_for_tutorials.html#data-for-tutorial"><span class="std std-ref">inertial range in the simulation</span></a>. The spatial frequencies used in the fit can be limited by setting <code class="xref py py-obj docutils literal notranslate"><span class="pre">low_cut</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">high_cut</span></code>. The inputs should have frequency units in pixels, angle, or physical units. In this case, we will limit the fitting between frequencies of <code class="xref py py-obj docutils literal notranslate"><span class="pre">0.02</span> <span class="pre">/</span> <span class="pre">pix</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">0.1</span> <span class="pre">/</span> <span class="pre">pix</span></code> (where the conversion to pixel scales in the simulation is just <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">freq</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span> <span class="n">low_cut</span><span class="o">=</span><span class="mf">0.02</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">high_cut</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.985</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.984</span>
<span class="go">Method:                 Least Squares   F-statistic:                     866.6</span>
<span class="go">Date:                Thu, 20 Jul 2017   Prob (F-statistic):           2.77e-13</span>
<span class="go">Time:                        15:28:29   Log-Likelihood:                 17.850</span>
<span class="go">No. Observations:                  15   AIC:                            -31.70</span>
<span class="go">Df Residuals:                      13   BIC:                            -30.28</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          3.7695      0.134     28.031      0.000       3.479       4.060</span>
<span class="go">x1            -3.0768      0.105    -29.438      0.000      -3.303      -2.851</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        1.873   Durbin-Watson:                   2.409</span>
<span class="go">Prob(Omnibus):                  0.392   Jarque-Bera (JB):                1.252</span>
<span class="go">Skew:                          -0.684   Prob(JB):                        0.535</span>
<span class="go">Kurtosis:                       2.641   Cond. No.                         13.5</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_vca_limitedfreq.png" src="../../_images/design4_vca_limitedfreq.png" />
<p>With the fit limited to the valid region, we find a shallower slope of <span class="math notranslate nohighlight">\(-3.1\pm0.1\)</span> and a better fit to the model. <code class="xref py py-obj docutils literal notranslate"><span class="pre">low_cut</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">high_cut</span></code> can also be given as spatial frequencies in angular units (e.g., <code class="xref py py-obj docutils literal notranslate"><span class="pre">u.deg**-1</span></code>). When a distance is given, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">low_cut</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">high_cut</span></code> can also be given in physical frequency units (e.g., <code class="xref py py-obj docutils literal notranslate"><span class="pre">u.pc**-1</span></code>).</p>
<p>This example has used the default ordinary least-squares fitting. A weighted least-squares can be enabled with <code class="xref py py-obj docutils literal notranslate"><span class="pre">weighted_fit=True</span></code> (this cannot be used for the segmented model described below).</p>
<p>Breaks in the power-law behaviour in observations (and higher-resolution simulations) can result from differences in the physical processes dominating at those scales. To capture this behaviour, <code class="xref py py-obj docutils literal notranslate"><span class="pre">VCA</span></code> can be passed a break point to enable fitting with a segmented linear model (<a class="reference internal" href="../../api/turbustat.statistics.Lm_Seg.html#turbustat.statistics.Lm_Seg" title="turbustat.statistics.Lm_Seg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Lm_Seg</span></code></a>; see the description given in the <a class="reference internal" href="pspec_example.html#pspec-tutorial"><span class="std std-ref">PowerSpectrum tutorial</span></a>). The 2D fitting is disabled for this section as it does handle fitting break points. In this example, we will assume a distance of 250 pc in order to show the power spectrum in physical units:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span> <span class="o">=</span> <span class="n">VCA</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">250</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span> <span class="n">low_cut</span><span class="o">=</span><span class="mf">0.02</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">high_cut</span><span class="o">=</span><span class="mf">0.4</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="n">fit_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">brk</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">fit_2D</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.998</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.998</span>
<span class="go">Method:                 Least Squares   F-statistic:                 1.113e+04</span>
<span class="go">Date:                Thu, 20 Jul 2017   Prob (F-statistic):           2.66e-90</span>
<span class="go">Time:                        16:19:33   Log-Likelihood:                 101.91</span>
<span class="go">No. Observations:                  71   AIC:                            -195.8</span>
<span class="go">Df Residuals:                      67   BIC:                            -186.8</span>
<span class="go">Df Model:                           3</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          3.6333      0.053     68.784      0.000       3.528       3.739</span>
<span class="go">x1            -3.1814      0.047    -67.916      0.000      -3.275      -3.088</span>
<span class="go">x2            -2.4558      0.094    -26.152      0.000      -2.643      -2.268</span>
<span class="go">x3            -0.0097      0.027     -0.355      0.724      -0.065       0.045</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        8.205   Durbin-Watson:                   1.148</span>
<span class="go">Prob(Omnibus):                  0.017   Jarque-Bera (JB):                7.707</span>
<span class="go">Skew:                          -0.772   Prob(JB):                       0.0212</span>
<span class="go">Kurtosis:                       3.469   Cond. No.                         20.8</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_vca_breakfit.png" src="../../_images/design4_vca_breakfit.png" />
<p>By incorporating the break, we find a better quality fit to this portion of the power-spectrum. We also find that the slope before the break (i.e., in the inertial range), the slope is consistent with the slope from the zeroth moment (<a class="reference internal" href="pspec_example.html#pspec-tutorial"><span class="std std-ref">PowerSpectrum tutorial</span></a>). The break point was moved significantly from the initial guess, which we had set to the upper limit of the inertial range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span><span class="o">.</span><span class="n">brk</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">&lt;Quantity 0.1624771454997838 1 / pix&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span><span class="o">.</span><span class="n">brk_err</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">&lt;Quantity 0.010241094948585336 1 / pix&gt;</span>
</pre></div>
</div>
<p>From the figure, this is where the curve deviates from the power-law on small scales. With our assigned distance, the break point corresponds to a physical scale of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span><span class="o">.</span><span class="n">_physical_size</span> <span class="o">/</span> <span class="n">vca</span><span class="o">.</span><span class="n">brk</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">&lt;Quantity 0.14082499334584425 pc&gt;</span>
</pre></div>
</div>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">vca._physical_size</span></code> is the spatial size of one pixel (assuming the spatial dimensions have square pixels in the celestial frame).</p>
<p>The values of the slope after the break point (<code class="xref py py-obj docutils literal notranslate"><span class="pre">x2</span></code>) in the fit description is defined relative to the first slope. Its actual slope would then be the sum of <code class="xref py py-obj docutils literal notranslate"><span class="pre">x1</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x2</span></code>. The slopes and their uncertainties can be accessed through:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span><span class="o">.</span><span class="n">slope</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">array([-3.18143757, -5.63724147])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span><span class="o">.</span><span class="n">slope_err</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">array([ 0.04684344,  0.104939  ])</span>
</pre></div>
</div>
<p>The slope above the break point is within the uncertainty of the slope we found in the second example (<span class="math notranslate nohighlight">\(-3.1\pm0.1\)</span>). The uncertainty we find here is nearly half of the previous one since more points have been used in this fit.</p>
<p>The Lazarian &amp; Pogosyan theory predicts that the VCA power-spectrum depends on the size of the velocity slices in the data cube (e.g., <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2001ApJ...551L..53S/abstract">Stanimirovic &amp; Lazarian 2001</a>). <a class="reference internal" href="../../api/turbustat.statistics.VCA.html#turbustat.statistics.VCA" title="turbustat.statistics.VCA"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VCA</span></code></a> allows for the velocity channel thickness to be changed with <code class="docutils literal notranslate"><span class="pre">channel_width</span></code>. This runs a routine that down-samples the spectral dimension to match the given <code class="docutils literal notranslate"><span class="pre">channel</span> <span class="pre">width</span></code>. We can re-run VCA on this data with a channel width of <span class="math notranslate nohighlight">\(\sim 400\)</span> m / s, and compare to the original slope:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vca_thicker_channel</span> <span class="o">=</span> <span class="n">VCA</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">250</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">channel_width</span><span class="o">=</span><span class="mi">400</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">downsample_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;downsample&#39;</span><span class="p">))</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vca_thicker</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span> <span class="n">low_cut</span><span class="o">=</span><span class="mf">0.02</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">high_cut</span><span class="o">=</span><span class="mf">0.4</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">fit_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">brk</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">),</span> <span class="n">fit_2D</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                       OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.998</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.998</span>
<span class="go">Method:                 Least Squares   F-statistic:                     9739.</span>
<span class="go">Date:                Thu, 20 Jul 2017   Prob (F-statistic):           2.29e-88</span>
<span class="go">Time:                        19:00:25   Log-Likelihood:                 94.310</span>
<span class="go">No. Observations:                  71   AIC:                            -180.6</span>
<span class="go">Df Residuals:                      67   BIC:                            -171.6</span>
<span class="go">Df Model:                           3</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          1.4422      0.057     25.516      0.000       1.329       1.555</span>
<span class="go">x1            -3.2388      0.051    -64.014      0.000      -3.340      -3.138</span>
<span class="go">x2            -2.8668      0.108    -26.651      0.000      -3.081      -2.652</span>
<span class="go">x3             0.0116      0.030      0.385      0.702      -0.049       0.072</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        7.262   Durbin-Watson:                   1.043</span>
<span class="go">Prob(Omnibus):                  0.026   Jarque-Bera (JB):                6.646</span>
<span class="go">Skew:                          -0.720   Prob(JB):                       0.0361</span>
<span class="go">Kurtosis:                       3.418   Cond. No.                         20.9</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_vca_400ms_channels.png" src="../../_images/design4_vca_400ms_channels.png" />
<p>With the original spectral resolution, the slope in the inertial range was already consistent with the “thickest slice” case, the zeroth moment. The slope here remains consistent with the zeroth moment power-spectrum, so for this data set of <span class="math notranslate nohighlight">\(^{13}{\rm CO}\)</span>, there is no evolution in the spectrum with channel size.</p>
<p>An alternative method to change the channel width can be used by specifying <code class="docutils literal notranslate"><span class="pre">downsample_kwargs=dict(method='regrid')</span></code>. The spectral axis of the cube is smoothed with a Gaussian kernel and down-sampled by interpolating to a new spectral axis with width <code class="docutils literal notranslate"><span class="pre">channel_width</span></code> (see the <a class="reference external" href="https://spectral-cube.readthedocs.io/en/latest/smoothing.html#spectral-smoothing">spectral-cube documentation</a>).</p>
<p>Constraints on the azimuthal angles used to compute the one-dimensional power-spectrum can also be given:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span> <span class="o">=</span> <span class="n">VCA</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vca</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="o">**-</span><span class="mi">1</span><span class="p">,</span> <span class="n">low_cut</span><span class="o">=</span><span class="mf">0.02</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">high_cut</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">radial_pspec_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;theta_0&quot;</span><span class="p">:</span> <span class="mf">1.13</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span> <span class="s2">&quot;delta_theta&quot;</span><span class="p">:</span> <span class="mi">40</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">})</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.958</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.955</span>
<span class="go">Method:                 Least Squares   F-statistic:                     298.9</span>
<span class="go">Date:                Fri, 29 Sep 2017   Prob (F-statistic):           2.36e-10</span>
<span class="go">Time:                        14:57:53   Log-Likelihood:                 11.566</span>
<span class="go">No. Observations:                  15   AIC:                            -19.13</span>
<span class="go">Df Residuals:                      13   BIC:                            -17.71</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          4.2111      0.204     20.597      0.000       3.769       4.653</span>
<span class="go">x1            -2.7475      0.159    -17.290      0.000      -3.091      -2.404</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                       18.967   Durbin-Watson:                   2.608</span>
<span class="go">Prob(Omnibus):                  0.000   Jarque-Bera (JB):               18.398</span>
<span class="go">Skew:                          -1.869   Prob(JB):                     0.000101</span>
<span class="go">Kurtosis:                       6.932   Cond. No.                         13.5</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_vca_limitedfreq_azimilimits.png" src="../../_images/design4_vca_limitedfreq_azimilimits.png" />
<p>The azimuthal limits now appear as contours on the two-dimensional power-spectrum in the figure. See the <a class="reference internal" href="pspec_example.html#pspec-tutorial"><span class="std std-ref">PowerSpectrum tutorial</span></a> for more information on giving azimuthal constraints.</p>
<p>If strong emission continues to the edge of the map (and the map does not have periodic boundaries), ringing in the FFT can introduce a cross pattern in the 2D power-spectrum. This effect and the use of apodizing kernels to taper the data is covered <a class="reference internal" href="../applying_apodizing_functions.html#apodkerns"><span class="std std-ref">here</span></a>.</p>
<p>Most observational data will be smoothed over the beam size, which will steepen the power spectrum on small scales.  To account for this, the 2D power spectrum can be divided by the beam response. This is demonstrated <a class="reference internal" href="../correcting_for_the_beam.html#correcting-for-beam"><span class="std std-ref">here</span></a> for spatial power-spectra.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2000ApJ...537..720L/abstract">Lazarian &amp; Pogosyan 2000</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2001ApJ...561..264D/abstract">Dickey et al. 2001</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2001ApJ...551L..53S/abstract">Stanimirovic &amp; Lazarian 2001</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2003ApJ...593..831M/abstract">Miville-Deschenes et al. 2003</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2004ApJ...616..943L/abstract">Lazarian &amp; Pogosyan 2004</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2004ApJ...616..845M/abstract">Muller et al. 2004</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2006ApJ...653L.125P/abstract">Padoan et al. 2006</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2009ApJ...693.1074C/abstract">Chepurnov &amp; Lazarian 2009</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2009SSRv..143..357L/abstract">Lazarian 2009</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2013ApJ...771..123B/abstract">Burkhart et al. 2013</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2016MNRAS.461.1227K/abstract">Kandel et al. 2016</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, TurbuStat Development Team.<br/>
      Last updated on 13 Feb 2019.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>