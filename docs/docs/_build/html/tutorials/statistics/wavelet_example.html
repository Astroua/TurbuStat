<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Wavelets &#8212; turbustat v1.0.dev2402</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Bispectrum Distance" href="../metrics/bispectrum_example.html" />
    <link rel="prev" title="Velocity Coordinate Spectrum (VCS)" href="vcs_example.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          turbustat</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.dev2402</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing TurbuStat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accepted_input_formats.html">Accepted Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preparing_simulated_data.html">Preparing Simulated Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_requirements.html">Data Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../moments.html">Deriving Cube Moments</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">TurbuStat Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generating_test_data.html">Creating testing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html#distance-metrics">Distance Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to TurbuStat</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Wavelets</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="vcs_example.html" title="Previous Chapter: Velocity Coordinate Spectrum (VCS)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Velocity Coor...</span>
    </a>
  </li>
  <li>
    <a href="../metrics/bispectrum_example.html" title="Next Chapter: Bispectrum Distance"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Bispectrum Distance &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/tutorials/statistics/wavelet_example.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Wavelets</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="wavelets">
<span id="wavelet-tutorial"></span><h1>Wavelets<a class="headerlink" href="#wavelets" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>A wavelet transform can be used to filter structure on certain scales, where the scale is typically related to the size and choice of wavelet kernel. By calculating the amount of structure using different sized kernels, the amount of structure on different scales can be calculated. This makes the technique similar to the power-spectrum, but the power at given scale is calculated in the image domain. This approach was introduced for use on astrophysical turbulence by <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1990ApJ...365L..27G/abstract">Gill &amp; Henriksen 1990</a>. They used a Mexican-Hat (or Ricker) wavelet for the transform and used the sum of positive values in each filtered map to produce a one-dimensional spectrum between the scale and amount of structure at that scale.</p>
<p>This technique has many similarities to <a class="reference internal" href="delta_variance_example.html#delvar-tutorial"><span class="std std-ref">Delta-Variance</span></a> (see comparison in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1999A&amp;A...347..630Z">Zielinsky &amp; Stutzki 1999</a>). Both create a set of filtered maps at different wavelet scales, though the Delta-Variance splits the wavelet kernel into separate component and normalizes by a weight map to reduce edge effects. From the filtered maps, the Delta-Variance measures the variance across the entire map to estimate the amount of structure, while the Wavelet transform assumes the amount of structure is represented by the total of the positive values. From both methods, the slope of the one-dimensional spectrum is the desired measurement.</p>
</div>
<div class="section" id="using">
<h2>Using<a class="headerlink" href="#using" title="Permalink to this headline">¶</a></h2>
<p><strong>The data in this tutorial are available</strong> <a class="reference external" href="https://girder.hub.yt/#user/57b31aee7b6f080001528c6d/folder/59721a30cc387500017dbe37">here</a>.</p>
<p>We need to import the <a class="reference internal" href="../../api/turbustat.statistics.Wavelet.html#turbustat.statistics.Wavelet" title="turbustat.statistics.Wavelet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Wavelet</span></code></a> class, along with a few other common packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">turbustat.statistics</span> <span class="k">import</span> <span class="n">Wavelet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
</pre></div>
</div>
<p>And we load in the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moment0</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Design4_flatrho_0021_00_radmc_moment0.fits&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>The default wavelet transform of the zeroth moment is calculated as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wavelet</span> <span class="o">=</span> <span class="n">Wavelet</span><span class="p">(</span><span class="n">moment0</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.954</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.953</span>
<span class="go">Method:                 Least Squares   F-statistic:                     1001.</span>
<span class="go">Date:                Tue, 01 Aug 2017   Prob (F-statistic):           8.36e-34</span>
<span class="go">Time:                        18:07:44   Log-Likelihood:                 97.550</span>
<span class="go">No. Observations:                  50   AIC:                            -191.1</span>
<span class="go">Df Residuals:                      48   BIC:                            -187.3</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          1.4175      0.012    119.360      0.000       1.394       1.441</span>
<span class="go">x1             0.3366      0.011     31.635      0.000       0.315       0.358</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        4.443   Durbin-Watson:                   0.048</span>
<span class="go">Prob(Omnibus):                  0.108   Jarque-Bera (JB):                2.578</span>
<span class="go">Skew:                          -0.334   Prob(JB):                        0.276</span>
<span class="go">Kurtosis:                       2.110   Cond. No.                         4.60</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_wavelet.png" src="../../_images/design4_wavelet.png" />
<p>The results of the fit and a plot overlaying the fit on the transform are shown with <code class="xref py py-obj docutils literal notranslate"><span class="pre">verbose=True</span></code>. The figure shows that the transform (blue diamonds) does not follow a single power-law relation across all of the scales and resulting fit (dashed blue line) is poor. The solid blue lines indicate the range of scales used in the fit. In the case of these simulated data, scales larger than about 25 pixels are affected by the edges of the map in the convolution. The flattening on scales just smaller is describing actual features in the data and may be a manifestation of the periodic box conditions; we see a similar feature with these data with the <a class="reference internal" href="delta_variance_example.html#delvar-tutorial"><span class="std std-ref">Delta-Variance</span></a> as well. Unlike the Delta-Variance, the deviation from a power-law is more pronounced on scales larger than about 10 pixels. To improve the fit, we can limit the region that is fit to below this scale:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wavelet</span> <span class="o">=</span> <span class="n">Wavelet</span><span class="p">(</span><span class="n">moment0</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelet</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xlow</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="n">xhigh</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.992</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.991</span>
<span class="go">Method:                 Least Squares   F-statistic:                     2758.</span>
<span class="go">Date:                Wed, 02 Aug 2017   Prob (F-statistic):           1.86e-25</span>
<span class="go">Time:                        14:05:44   Log-Likelihood:                 78.364</span>
<span class="go">No. Observations:                  25   AIC:                            -152.7</span>
<span class="go">Df Residuals:                      23   BIC:                            -150.3</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          1.3279      0.006    215.931      0.000       1.315       1.341</span>
<span class="go">x1             0.4946      0.009     52.516      0.000       0.475       0.514</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        4.021   Durbin-Watson:                   0.122</span>
<span class="go">Prob(Omnibus):                  0.134   Jarque-Bera (JB):                3.476</span>
<span class="go">Skew:                          -0.888   Prob(JB):                        0.176</span>
<span class="go">Kurtosis:                       2.572   Cond. No.                         5.95</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_wavelet_fitlimits.png" src="../../_images/design4_wavelet_fitlimits.png" />
<p>This has significantly improved the fit, and the slope of the power-law is closer to the value found from the <a class="reference internal" href="delta_variance_example.html#delvar-tutorial"><span class="std std-ref">Delta-Variance transform</span></a>. The wavelet transform slope is half of the Delta-Variance slope:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wavelet</span><span class="o">.</span><span class="n">slope</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">0.98916576820595215</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelet</span><span class="o">.</span><span class="n">slope_err</span> <span class="o">*</span><span class="mi">2</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">0.018835675570973334</span>
</pre></div>
</div>
<p>The wavelet transform gives an index of <span class="math notranslate nohighlight">\(0.99 \pm 0.02\)</span>, while the Delta-Variance has a slope of <span class="math notranslate nohighlight">\(1.06 \pm 0.02\)</span> fit over a similar range. While limiting the fit gives a consistent result to other methods, the differences in the shape of the spectra may give useful information and should be interpreted carefully.</p>
<p>These examples have used the default scales to calculate the wavelet transforms. The default, in pixel units, will vary from 1.5 pixels to half of the smallest image dimension and will be spaced equally in logarithmic space. The number of scales to test defaults to 50; this can be changed by giving the <code class="xref py py-obj docutils literal notranslate"><span class="pre">num</span></code> keyword to <a class="reference internal" href="../../api/turbustat.statistics.Wavelet.html#turbustat.statistics.Wavelet" title="turbustat.statistics.Wavelet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Wavelet</span></code></a>. Alternatively, a custom set of scales can be given. The units of the scale can also be given in both angular and physical units (when a distance is provided). This can be useful for comparing different datasets at a common scale. For example, assume that this simulated dataset lies at a distance of 250 pc:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phys_scales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelet</span> <span class="o">=</span> <span class="n">Wavelet</span><span class="p">(</span><span class="n">moment0</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">250</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">scales</span><span class="o">=</span><span class="n">phys_scales</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelet</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xlow</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="n">xhigh</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.983</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  0.977</span>
<span class="go">Method:                 Least Squares   F-statistic:                     173.6</span>
<span class="go">Date:                Wed, 02 Aug 2017   Prob (F-statistic):           0.000944</span>
<span class="go">Time:                        14:43:07   Log-Likelihood:                 11.334</span>
<span class="go">No. Observations:                   5   AIC:                            -18.67</span>
<span class="go">Df Residuals:                       3   BIC:                            -19.45</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          1.2668      0.031     41.159      0.000       1.169       1.365</span>
<span class="go">x1             0.5649      0.043     13.178      0.001       0.428       0.701</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                          nan   Durbin-Watson:                   1.633</span>
<span class="go">Prob(Omnibus):                    nan   Jarque-Bera (JB):                0.461</span>
<span class="go">Skew:                           0.166   Prob(JB):                        0.794</span>
<span class="go">Kurtosis:                       1.549   Cond. No.                         4.25</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_wavelet_physunits.png" src="../../_images/design4_wavelet_physunits.png" />
<p>We find a similar slope using the same fit region as the previous example, though with more uncertainty since only 5 of the given scales fit into the region. Note that the plot now shows the scales in parsecs, as well. The output unit used in the plot can be changed by specifying <code class="xref py py-obj docutils literal notranslate"><span class="pre">xunit</span></code>. Similarly, different units can be used in <code class="xref py py-obj docutils literal notranslate"><span class="pre">xlow</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">xhigh</span></code>, too.</p>
<p>Finally, we note a difference between the TurbuStat implementation of the wavelet transform and the one described in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1990ApJ...365L..27G/abstract">Gill &amp; Henriksen 1990</a>. Their definition of the Mexican-Hat wavelet in Section 2 is an unnormalized form of the kernel and this leads to a slope of <span class="math notranslate nohighlight">\(+2\)</span> larger than the normalized version here. We use the <a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.convolution.MexicanHat2DKernel.html">Mexican-Hat implementation</a> from the <a class="reference external" href="http://docs.astropy.org/en/stable/convolution/index.html">astropy.convolution</a> package, which has the correct <span class="math notranslate nohighlight">\(1/\pi \sigma^4\)</span> normalization coefficient for the wavelet transform.</p>
<p>The <span class="math notranslate nohighlight">\(+2\)</span> discrepancy can be explained by thinking of the Mexican-Hat kernel as the negative of the Laplacian of a Gaussian. A normalized Gaussian has a normalization constant of <span class="math notranslate nohighlight">\(1/2 \pi \sigma^2\)</span>, or units of <span class="math notranslate nohighlight">\(1/{\rm length}^2\)</span>, but has a constant peak for all <span class="math notranslate nohighlight">\(\sigma\)</span>. In order to make the Laplacian also have a constant peak, referred to as a <em>scale-normalized derivative</em> in <a class="reference external" href="https://en.wikipedia.org/wiki/Scale_space">image processing</a>, we need to multiply the Mexican-Hat by a factor of <span class="math notranslate nohighlight">\(\sigma^2\)</span> at each scale. Combined with the normalization coefficient of <span class="math notranslate nohighlight">\(1/\pi \sigma^4\)</span>, this restores the <span class="math notranslate nohighlight">\(1/{\rm length}^2\)</span> of a Gaussian (<a class="reference external" href="https://www.tandfonline.com/doi/abs/10.1080/757582976">Lindeburg 1994</a>). In order to reproduce the unnormalized version of <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1990ApJ...365L..27G/abstract">Gill &amp; Henriksen 1990</a>, we need to multiply the kernel by <span class="math notranslate nohighlight">\(\sigma^4\)</span>. To reproduce their results, we have included a normalization keyword to disable the correct normalization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wavelet</span> <span class="o">=</span> <span class="n">Wavelet</span><span class="p">(</span><span class="n">moment0</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelet</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale_normalization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">xhigh</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            OLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       1.000</span>
<span class="go">Model:                            OLS   Adj. R-squared:                  1.000</span>
<span class="go">Method:                 Least Squares   F-statistic:                 7.016e+04</span>
<span class="go">Date:                Wed, 02 Aug 2017   Prob (F-statistic):           1.40e-41</span>
<span class="go">Time:                        15:10:40   Log-Likelihood:                 78.364</span>
<span class="go">No. Observations:                  25   AIC:                            -152.7</span>
<span class="go">Df Residuals:                      23   BIC:                            -150.3</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const          1.3279      0.006    215.931      0.000       1.315       1.341</span>
<span class="go">x1             2.4946      0.009    264.879      0.000       2.475       2.514</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        4.021   Durbin-Watson:                   0.122</span>
<span class="go">Prob(Omnibus):                  0.134   Jarque-Bera (JB):                3.476</span>
<span class="go">Skew:                          -0.888   Prob(JB):                        0.176</span>
<span class="go">Kurtosis:                       2.572   Cond. No.                         5.95</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_wavelet_unnorm.png" src="../../_images/design4_wavelet_unnorm.png" />
<p>The unnormalized transform appears to follow a power-law relation over all of the scales, and when limited to the same fitting region, the fit appears to be much better. This is deceiving, however, because the extra factors of <span class="math notranslate nohighlight">\(\sigma\)</span> are increasing the correlation between the x and y variables in the fit! This effectively gives a slope of <span class="math notranslate nohighlight">\(+2\)</span> for free, regardless of the data. Further, it means that the fit statistics are no longer valid, as the underlying assumption in the model is that the y and x values are uncorrelated.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">We do <strong>not</strong> recommend using the unnormalized form as it inflates the quality of the fit, hides the deviations (that may be physically relevant!), but provides no additional information or improvements.</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1990ApJ...365L..27G/abstract">Gill &amp; Henriksen 1990</a></p>
<p><a class="reference external" href="https://www.tandfonline.com/doi/abs/10.1080/757582976">Lindeburg 1994</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1999A&amp;A...347..630Z">Zielinsky &amp; Stutzki 1999</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, TurbuStat Development Team.<br/>
      Last updated on 13 Feb 2019.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>