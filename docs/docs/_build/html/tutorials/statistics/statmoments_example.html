<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Statistical Moments &#8212; turbustat v1.0.dev2406</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tsallis Statistics" href="tsallis_example.html" />
    <link rel="prev" title="Spectral Correlation Function (SCF)" href="scf_example.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          turbustat</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.dev2406</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing TurbuStat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accepted_input_formats.html">Accepted Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preparing_simulated_data.html">Preparing Simulated Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_requirements.html">Data Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../moments.html">Deriving Cube Moments</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">TurbuStat Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generating_test_data.html">Creating testing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html#distance-metrics">Distance Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to TurbuStat</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Statistical Moments</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="scf_example.html" title="Previous Chapter: Spectral Correlation Function (SCF)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Spectral Corr...</span>
    </a>
  </li>
  <li>
    <a href="tsallis_example.html" title="Next Chapter: Tsallis Statistics"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Tsallis Statistics &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/tutorials/statistics/statmoments_example.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Statistical Moments</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="statistical-moments">
<span id="statmoments-tutorial"></span><h1>Statistical Moments<a class="headerlink" href="#statistical-moments" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>A commonly used analysis technique with spectral-line data cubes is to find the moment of each spectrum (<a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1994ApJ...436..728F/abstract">Falgarone et al. 1994</a>). Alternatively, moments can be computed using the distribution of values in an image or a region within an image. This idea was introduced by <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2007ApJ...658..423K/abstract">Kowal et al. 2007</a> and extended in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2010ApJ...708.1204B/abstract">Burkhart et al. 2010</a>, who computed the mean, variance, skewness, and kurtosis within circular regions across an image. These moments provide an estimate of how the intensity structure varies across an image. Using different neighborhood sizes to compute these statistics will emphasize or hide variations on the different spatial scales.</p>
<p>The moments have the following definitions measured within a circular neighborhood <span class="math notranslate nohighlight">\(|\mathbf{x}'-\mathbf{x}|\le r\)</span> with radius <span class="math notranslate nohighlight">\(r\)</span> on a two-dimensional image <span class="math notranslate nohighlight">\(I\)</span>:</p>
<p>The mean is defined as:</p>
<div class="math notranslate nohighlight">
\[\mu_r(\mathbf{x}) = \frac{\sum_{|\mathbf{x}'-\mathbf{x}|\le r} w_i(\boldsymbol{x}) I(\boldsymbol{x})}{\sum_{|\mathbf{x}'-\mathbf{x}|\le r} w_i(\boldsymbol{x})}\]</div>
<p>where <span class="math notranslate nohighlight">\(I(\boldsymbol{x})\)</span> are the values within the neighborhood region, and <span class="math notranslate nohighlight">\(w_i\)</span> is the noise variance at that position (e.g., for a zeroth moment map <span class="math notranslate nohighlight">\(M_0(\boldsymbol{x})\)</span>, <span class="math notranslate nohighlight">\(w_i(\boldsymbol{x}) = [\sigma_{M_0}(\boldsymbol{x})]\)</span>).</p>
<p>The variance is defined as:</p>
<div class="math notranslate nohighlight">
\[\sigma^2_r(\boldsymbol{x}) \equiv \frac{\sum_{|\mathbf{x}'-\mathbf{x}|\le r} w_i(\boldsymbol{x}) \left( I - \mu_r(\mathbf{x}) \right)^2}{\sum{|\mathbf{x}'-\mathbf{x}|\le r} w_i(\boldsymbol{x})}.\]</div>
<p>The skewness is defined as:</p>
<div class="math notranslate nohighlight">
\[\gamma_{3,r}(\mathbf{x}) \equiv \frac{\sum_{|\mathbf{x}'-\mathbf{x}|\le r} w(\mathbf{x}')\left[\frac{I(\mathbf{x}')-\mu_r(\mathbf{x})}{\sigma_r(\mathbf{x})}\right]^3}{\sum_{|\mathbf{x}'-\mathbf{x}|\le r} w(\mathbf{x}')}.\]</div>
<p>And the kurtosis is defined as:</p>
<div class="math notranslate nohighlight">
\[\gamma_{4,r}(\mathbf{x}) \equiv \frac{\sum_{|\mathbf{x}'-\mathbf{x}|\le r} w(\mathbf{x}') \left[\frac{I(\mathbf{x}')-\mu_r(\mathbf{x})}{\sigma_r(\mathbf{x})}\right]^4}{\sum_{|\mathbf{x}'-\mathbf{x}|\le r} w(\mathbf{x}')} - 3.\]</div>
<p>For the purpose of comparing these spatial moment maps between data sets, <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2010ApJ...708.1204B/abstract">Burkhart et al. 2010</a> recommend using the third and fourth moments—the skewness and kurtosis, respectively—since they are independent of the mean and normalized by the standard deviation.</p>
</div>
<div class="section" id="using">
<h2>Using<a class="headerlink" href="#using" title="Permalink to this headline">¶</a></h2>
<p><strong>The data in this tutorial are available</strong> <a class="reference external" href="https://girder.hub.yt/#user/57b31aee7b6f080001528c6d/folder/59721a30cc387500017dbe37">here</a>.</p>
<p>Import a few packages that are needed and read-in the zeroth moment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">turbustat.statistics</span> <span class="k">import</span> <span class="n">StatMoments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moment0</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Design4_flatrho_0021_00_radmc_moment0.fits&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>The moment0 HDU and radius of the neighborhood are given to initialize <a class="reference internal" href="../../api/turbustat.statistics.StatMoments.html#turbustat.statistics.StatMoments" title="turbustat.statistics.StatMoments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StatMoments</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span> <span class="o">=</span> <span class="n">StatMoments</span><span class="p">(</span><span class="n">moment0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>This simulated data has periodic boundaries, so we enable <code class="xref py py-obj docutils literal notranslate"><span class="pre">periodic=True</span></code> when computing the spatial moment maps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_frac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<img alt="../../_images/design4_statmoments.png" src="../../_images/design4_statmoments.png" />
<p>Overlaid on all four plots are the intensity contours from the zeroth moment, making it easier to compare the moment structures to the intensity. Some of the moment maps are more useful than others. For example the mean array is simply a smoothed version of the zeroth moment. The variance map scales closely with the peaks in emission. The skewness and kurtosis maps show perhaps the more interesting products. Both emphasize regions with sharper gradients in the intensity map, and since both are scaled by the variance, they are independent of the intensity scaling.</p>
<p>The moment maps are shown above, but the distributions of the moments are of greater interest for comparing with other data sets. <a class="reference internal" href="../../api/turbustat.statistics.StatMoments.html#turbustat.statistics.StatMoments.plot_histograms" title="turbustat.statistics.StatMoments.plot_histograms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_histograms</span></code></a> plots, and optionally saves, the histograms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">plot_histograms</span><span class="p">()</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<img alt="../../_images/design4_statmoments_hists.png" src="../../_images/design4_statmoments_hists.png" />
<p>Again, the mean is just a smoothed version of the zeroth moment values. The variance has a strong tail, emphasized by the square term at high intensity peak in the map. The skewness and kurtosis provide distributions of normalized parameters, making it easier to use these quantities for comparing to other data sets.</p>
<p>This example does not include any blanked regions, though observational data often do. To avoid edge effects near these regions, a limit can be set on the minimum fraction of finite points within each region with <code class="xref py py-obj docutils literal notranslate"><span class="pre">min_frac</span></code>. By default, <code class="xref py py-obj docutils literal notranslate"><span class="pre">min_frac</span></code> is set to 0.8. To completely remove edge effects, this parameter can be increased to 1 to reject all regions that contain a NaN. Note that this will increase the size of the blank region by your chosen radius.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>This example uses data that are noiseless. If these data <em>did</em> have noise, it would be critical to remove the noise-dominated regions when computing the skewness and kurtosis, in particular, since they are normalized by the variance. To minimize the effect of noise, the data can be masked beforehand or an array of weights can be passed to down-weight noisy regions. We recommend using the latter method. For example, a weight array could be the inverse squared noise level of the data. Assume the noise level is set to make the signal-to-noise ratio 10 for every pixel in the map:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">3434789</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">moment0</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">moment0</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moments_weighted</span> <span class="o">=</span> <span class="n">StatMoments</span><span class="p">(</span><span class="n">moment0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">weights</span><span class="o">=</span><span class="n">noise</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moments_weighted</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
</div>
<img alt="../../_images/design4_statmoments_randweights.png" src="../../_images/design4_statmoments_randweights.png" />
<p>And the associated histograms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moments_weighted</span><span class="o">.</span><span class="n">plot_histograms</span><span class="p">()</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<img alt="../../_images/design4_statmoments_hists_randweights.png" src="../../_images/design4_statmoments_hists_randweights.png" />
<p>An important consideration when choosing the radius is the balance between tracking small-scale variations and the increased uncertainty when estimating the moments with less data. <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2010ApJ...708.1204B/abstract">Burkhart et al. 2010</a> use approximate formulae for the standard errors of skewness and kurtosis for a normal distribution that are valid for large samples. These are <span class="math notranslate nohighlight">\(\sqrt{6 / n}\)</span> for skewness and <span class="math notranslate nohighlight">\(\sqrt{24 / n}\)</span> for kurtosis, where <span class="math notranslate nohighlight">\(n\)</span> is the number of points. This also assumes all of these points are <em>independent</em> of each other. This typically is not true of observational data, where the data are correlated on at least the beam scale. Each of these points should be considered when choosing the minimum radius appropriate for the data set. For more information on the standard errors, see the sections on <a class="reference external" href="https://en.wikipedia.org/wiki/Skewness#Sample_skewness">skewness</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Kurtosis#Sample_kurtosis">kurtosis</a> on their Wikipedia pages.</p>
<p>What happens if the radius is chosen to be too small, making the higher-order moments highly uncertain? A new radius can be given to <a class="reference internal" href="../../api/turbustat.statistics.StatMoments.html#turbustat.statistics.StatMoments.run" title="turbustat.statistics.StatMoments.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> to replace the first one given:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">plot_histograms</span><span class="p">()</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<img alt="../../_images/design4_statmoments_hists_rad_2pix.png" src="../../_images/design4_statmoments_hists_rad_2pix.png" />
<p>The skewness distribution is narrower, but the kurtosis is wider. The kurtosis uncertainty is larger than the skewness uncertainty, leading to a broader distribution. What are the distribution shapes using larger radii?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">plot_histograms</span><span class="p">()</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<img alt="../../_images/design4_statmoments_hists_rad_10pix.png" src="../../_images/design4_statmoments_hists_rad_10pix.png" />
<p>The skewness and kurtosis distributions are not significantly different from the first example, which used <code class="xref py py-obj docutils literal notranslate"><span class="pre">radius=5</span> <span class="pre">*</span> <span class="pre">u.pix</span></code>. This seems to suggest that radii in this range give values that are not primarily dominated by the measurement uncertainty. The variance distribution has changed though: its peak is no longer at 0. When averaging over a region larger than the size of most of the structure, the peak of the variance should start to become larger than 0. How about computing moments over a much larger radius?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">32</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">plot_histograms</span><span class="p">()</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<img alt="../../_images/design4_statmoments_hists_rad_32pix.png" src="../../_images/design4_statmoments_hists_rad_32pix.png" />
<p>This is clearly too large of a region to be using for this data. A radius of 32 pixels means using a circular region half the size of the image, and there are artifacts dominated by single prominent features in the map, leading to weird multi-model moment distributions.</p>
<p>Because this method relies significantly on the pixel size of the map (for small radii), comparing data sets is best done on a common grid. However, if larger radii are being used, the pixel-to-pixel variation will not be as important.</p>
<p>Often it is more convenient to specify scales in angular or physical units, rather than pixels. <code class="xref py py-obj docutils literal notranslate"><span class="pre">radius</span></code> can be given as either, so long as a distance is provided. For example, assume the distance to the cloud in this data is 250 pc and we want the radius to be 0.23 pc:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span> <span class="o">=</span> <span class="n">StatMoments</span><span class="p">(</span><span class="n">moment0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.23</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">plot_histograms</span><span class="p">()</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<img alt="../../_images/design4_statmoments_hists_physunits.png" src="../../_images/design4_statmoments_hists_physunits.png" />
<p>When a radius is given in angular or physical units, the radius of the region used is rounded <em>down</em> to the nearest integer. In this case, 0.23 pc rounds down to 10 pixels and we find the same distributions shown above for the <code class="xref py py-obj docutils literal notranslate"><span class="pre">radius=10*u.pix</span></code> case.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1994ApJ...436..728F/abstract">Falgarone et al. 1994</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1999ApJ...525..318P/abstract">Padoan et al. 1999</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2007ApJ...658..423K/abstract">Kowal et al. 2007</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2009ApJ...693..250B/abstract">Burkhart et al. 2009</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2010ApJ...708.1204B/abstract">Burkhart et al. 2010</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2013ApJ...771..122B/abstract">Burkhart et al. 2013</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2015ApJ...808...48B/abstract">Burkhart et al. 2015</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, TurbuStat Development Team.<br/>
      Last updated on 14 Feb 2019.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>