<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Spectral Correlation Function (SCF) &#8212; turbustat v1.0.dev2395</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Statistical Moments" href="statmoments_example.html" />
    <link rel="prev" title="Spatial Power Spectrum" href="pspec_example.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          turbustat</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.dev2395</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing TurbuStat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accepted_input_formats.html">Accepted Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preparing_simulated_data.html">Preparing Simulated Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_requirements.html">Data Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../moments.html">Deriving Cube Moments</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">TurbuStat Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generating_test_data.html">Creating testing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html#distance-metrics">Distance Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to TurbuStat</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Spectral Correlation Function (SCF)</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="pspec_example.html" title="Previous Chapter: Spatial Power Spectrum"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Spatial Power...</span>
    </a>
  </li>
  <li>
    <a href="statmoments_example.html" title="Next Chapter: Statistical Moments"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Statistical Moments &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/tutorials/statistics/scf_example.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Spectral Correlation Function (SCF)</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="spectral-correlation-function-scf">
<span id="scf-tutorial"></span><h1>Spectral Correlation Function (SCF)<a class="headerlink" href="#spectral-correlation-function-scf" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The Spectral Correlation Function was introduced by <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1999ApJ...524..887R/abstract">Rosolowsky et al. 1999</a> and <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2001ApJ...547..862P/abstract">Padoan et al. 2001</a> to quantify the correlation of a spectral-line data cube as a function of spatial separation. There are different forms of the SCF described in the literature (e.g., <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2003ApJ...588..881P/abstract">Padaon et al. 2003</a>). TurbuStat contains the SCF form described in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2003ApJ...588..881P/abstract">Padaon et al. 2003</a>, which has been used in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2014ApJ...783...93Y/abstract">Yeremi et al. 2014</a> and <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2015ApJ...799..235G/abstract">Gaches et al. 2015</a>.</p>
<div class="math notranslate nohighlight">
\[S(\boldsymbol{\ell}) = 1 - \left\langle \sqrt{\frac{\sum_v
|I(\mathbf{x},v)-I(\mathbf{x}+\boldsymbol{\ell},v)|^2}{\sum_v
|I(\mathbf{x},v)|^2+\sum_v |I(\mathbf{x}+\boldsymbol{\ell},v)|^2}}\right\rangle_{\mathbf{x}}.\]</div>
<p><span class="math notranslate nohighlight">\(S(\boldsymbol{\ell})\)</span> is the total correlation between the cube, and the cube shifted by the <em>lag</em>, the vector <span class="math notranslate nohighlight">\(\boldsymbol{\ell}=(\Delta x, \Delta y)\)</span>. By repeating this process for a series of <span class="math notranslate nohighlight">\(\Delta x, \Delta y)\)</span> in the spatial dimensions, a 2D correlation surface is created. This surface describes the spatial scales on which the spectral features begin to change.</p>
<p>The correlation surface can be further simplified by computing an azimuthal average, yielding a 1D spectrum of the correlation vs. length of the lag vector. This form, as is presented in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1999ApJ...524..887R/abstract">Rosolowsky et al. 1999</a> and <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2001ApJ...547..862P/abstract">Padoan et al. 2001</a>, yields a power-law relation, whose slope can be used to quantify differences between different spectral cubes. An example of this comparison is the study by <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2015ApJ...799..235G/abstract">Gaches et al. 2015</a>, where the effect of chemical species analyzed is traced through changes in the SCF slope.</p>
</div>
<div class="section" id="using">
<h2>Using<a class="headerlink" href="#using" title="Permalink to this headline">¶</a></h2>
<p><strong>The data in this tutorial are available</strong> <a class="reference external" href="https://girder.hub.yt/#user/57b31aee7b6f080001528c6d/folder/59721a30cc387500017dbe37">here</a>.</p>
<p>Importing a few common packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">turbustat.statistics</span> <span class="k">import</span> <span class="n">SCF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
</pre></div>
</div>
<p>And we load in the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Design4_flatrho_0021_00_radmc.fits&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>The cube and lags to use are given to initialize the <a class="reference internal" href="../../api/turbustat.statistics.SCF.html#turbustat.statistics.SCF" title="turbustat.statistics.SCF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SCF</span></code></a>  class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span> <span class="o">=</span> <span class="n">SCF</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">size</span></code> describes the total size of one dimension of the correlation surface and will compute the SCF up to a lag of 5 pixels in each direction. Alternatively, a set of custom lag values can be passed using <code class="xref py py-obj docutils literal notranslate"><span class="pre">roll_lags</span></code> (see the example with physical units below). No restriction is placed on the values of these lags, however the azimuthally-averaged spectrum is only usable if the given lags are symmetric with positive and negative values. Also note that lags do not have to be integer values! <a class="reference internal" href="../../api/turbustat.statistics.SCF.html#turbustat.statistics.SCF" title="turbustat.statistics.SCF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SCF</span></code></a> handles non-integer shifts by shifting the data in the Fourier plane.</p>
<p>To compute the SCF, we run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            WLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.991</span>
<span class="go">Model:                            WLS   Adj. R-squared:                  0.990</span>
<span class="go">Method:                 Least Squares   F-statistic:                     661.0</span>
<span class="go">Date:                Tue, 18 Jul 2017   Prob (F-statistic):           2.28e-07</span>
<span class="go">Time:                        10:07:56   Log-Likelihood:                 26.958</span>
<span class="go">No. Observations:                   8   AIC:                            -49.92</span>
<span class="go">Df Residuals:                       6   BIC:                            -49.76</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const         -0.0450      0.001    -33.254      0.000      -0.048      -0.042</span>
<span class="go">x1            -0.1624      0.006    -25.710      0.000      -0.178      -0.147</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        1.340   Durbin-Watson:                   0.445</span>
<span class="go">Prob(Omnibus):                  0.512   Jarque-Bera (JB):                0.696</span>
<span class="go">Skew:                          -0.248   Prob(JB):                        0.706</span>
<span class="go">Kurtosis:                       1.643   Cond. No.                         4.70</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_scf.png" src="../../_images/design4_scf.png" />
<p>The summary plot shows the correlation surface, a histogram of correlation values, and the 1D spectrum from the azimuthal average, plotted with the power-law fit. A weighted least-squares fit is used to find the slope of the SCF spectrum, where the inverse squared standard deviation from the azimuthal average are used as the weights. The solid contours on the SCF surface are from the 2D fit to the surface, while the blue dot-dashed lines are the extents of the data used in the fit (and match the 1D spectrum limits). See the <a class="reference internal" href="pspec_example.html#pspec-tutorial"><span class="std std-ref">PowerSpectrum tutorial</span></a> for a more thorough discussion of the two-dimensional fitting.</p>
<p>The 2D model parameters are not shown in the above summary. Instead, the parameters can be accessed with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">slope2D</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">slope2D_err</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">(-0.21648274416050342, 0.0029877489213308711)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">ellip2D</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">ellip2D_err</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">(0.89100428375797669, 0.013283231941591638)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">theta2D</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">theta2D_err</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">(0.33117523945671401, 0.06876652735591221)</span>
</pre></div>
</div>
<p>Since each value in the SCF surface is an average over the whole cube, it tends to be less affected by noise than the power-spectrum based methods (e.g., <a class="reference internal" href="pspec_example.html#pspec-tutorial"><span class="std std-ref">PowerSpectrum tutorial</span></a>) and the 2D fit is highly constrained despite having many fewer points to fit. The slope of the 2D model is much steeper than the slope of the 1D model. In the 2D model, the index is defined to be the slope along the minor axis, where the slope is the steepest. The ability to return the slope at any angle will be added to TurbuStat in a future release.</p>
<p>Real data may not have a spectrum described by a single power-law. In this case, the fit limits can be specified using <code class="xref py py-obj docutils literal notranslate"><span class="pre">xlow</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">xhigh</span></code> to limit which scales are used in the fit.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xlow</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="n">xhigh</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            WLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.983</span>
<span class="go">Model:                            WLS   Adj. R-squared:                  0.975</span>
<span class="go">Method:                 Least Squares   F-statistic:                     118.9</span>
<span class="go">Date:                Tue, 18 Jul 2017   Prob (F-statistic):            0.00831</span>
<span class="go">Time:                        10:10:42   Log-Likelihood:                 16.864</span>
<span class="go">No. Observations:                   4   AIC:                            -29.73</span>
<span class="go">Df Residuals:                       2   BIC:                            -30.95</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const         -0.0103      0.010     -1.036      0.409      -0.053       0.032</span>
<span class="go">x1            -0.2027      0.019    -10.902      0.008      -0.283      -0.123</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                          nan   Durbin-Watson:                   2.000</span>
<span class="go">Prob(Omnibus):                    nan   Jarque-Bera (JB):                0.637</span>
<span class="go">Skew:                          -0.020   Prob(JB):                        0.727</span>
<span class="go">Kurtosis:                       1.045   Cond. No.                         10.0</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_scf_fitlimits.png" src="../../_images/design4_scf_fitlimits.png" />
<p>The one-dimensional power spectrum in the previous examples is averaged over all azimuthal angles. In cases where only a certain range of angles is of interest, limits on the averaged azimuthal angles can be given:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xlow</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span> <span class="n">xhigh</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">radialavg_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;theta_0&quot;</span><span class="p">:</span> <span class="mf">1.13</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="s2">&quot;delta_theta&quot;</span><span class="p">:</span> <span class="mi">70</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">})</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            WLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.987</span>
<span class="go">Model:                            WLS   Adj. R-squared:                  0.981</span>
<span class="go">Method:                 Least Squares   F-statistic:                     157.2</span>
<span class="go">Date:                Mon, 02 Oct 2017   Prob (F-statistic):            0.00630</span>
<span class="go">Time:                        09:00:45   Log-Likelihood:                 17.721</span>
<span class="go">No. Observations:                   4   AIC:                            -31.44</span>
<span class="go">Df Residuals:                       2   BIC:                            -32.67</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const         -0.0067      0.010     -0.695      0.559      -0.048       0.035</span>
<span class="go">x1            -0.2098      0.017    -12.539      0.006      -0.282      -0.138</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                          nan   Durbin-Watson:                   1.899</span>
<span class="go">Prob(Omnibus):                    nan   Jarque-Bera (JB):                0.449</span>
<span class="go">Skew:                          -0.003   Prob(JB):                        0.799</span>
<span class="go">Kurtosis:                       1.358   Cond. No.                         14.4</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_scf_fitlimits_azimlimits.png" src="../../_images/design4_scf_fitlimits_azimlimits.png" />
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">theta_0</span></code> is the angle at the center of the azimuthal mask and <code class="xref py py-obj docutils literal notranslate"><span class="pre">delta_theta</span></code> is the width of that mask. The mask is shown on the SCF surface by the radial blue-dashed contours.</p>
<p>Here the fit limits were given in pixel units, but angular units and physical units (if a distance is given) can also be passed. For these data, there is some deviation from a power-law at small lags over the range of lags used and so limiting the fitting range has not significantly changed the fit. See Figure 8 in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2001ApJ...547..862P/abstract">Padoan et al. 2001</a> for an example of deviations from power-law behaviour in the SCF spectrum.</p>
<p>The slope of the model can be accessed with <code class="xref py py-obj docutils literal notranslate"><span class="pre">scf.slope</span></code> and its standard error with <code class="xref py py-obj docutils literal notranslate"><span class="pre">scf.slope_err</span></code>. The slope and intercept values are in <code class="xref py py-obj docutils literal notranslate"><span class="pre">scf.fit.params</span></code>. <code class="xref py py-obj docutils literal notranslate"><span class="pre">scf.fitted_model</span></code> can be used to evaluate the model at any given lag value. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">fitted_model</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">0.97659777310171636</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">fitted_model</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">array([ 0.97659777,  0.61242384])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">fitted_model</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">array([ 0.44197356,  0.3840506 ])</span>
</pre></div>
</div>
<p>All values passed must have an attached unit. Physical units can be given when a distance has been given (see below).</p>
<p>In some cases, it may be preferable to calculate the SCF on specific physical scales. When <a class="reference internal" href="../../api/turbustat.statistics.SCF.html#turbustat.statistics.SCF" title="turbustat.statistics.SCF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SCF</span></code></a> is given a distance,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">roll_lags</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">xlow</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">xhigh</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">xunit</span></code> can be given in physical units. Angular units can always be given, as well, since <a class="reference internal" href="../../api/turbustat.statistics.SCF.html#turbustat.statistics.SCF" title="turbustat.statistics.SCF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SCF</span></code></a> requires a FITS header. In this example, we will use a set of custom lags in physical units:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span> <span class="o">=</span> <span class="mi">250</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pc</span>  <span class="c1"># Assume a distance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phys_conv</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CDELT2&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">rad</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">distance</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">phys_conv</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">custom_lags</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">[-0.10296379 -0.06864253 -0.03432126  0.          0.03432126  0.06864253 0.10296379] pc</span>
</pre></div>
</div>
<p>The lags here are equally spaced and centered around zero. <code class="xref py py-obj docutils literal notranslate"><span class="pre">phys_conv</span></code> converts the pixel values into physical units. When calling <a class="reference internal" href="../../api/turbustat.statistics.SCF.html#turbustat.statistics.SCF" title="turbustat.statistics.SCF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SCF</span></code></a>, the distance must now be given:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scf_physroll</span> <span class="o">=</span> <span class="n">SCF</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">roll_lags</span><span class="o">=</span><span class="n">custom_lags</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">distance</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scf_physroll</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">pc</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            WLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.892</span>
<span class="go">Model:                            WLS   Adj. R-squared:                  0.856</span>
<span class="go">Method:                 Least Squares   F-statistic:                     24.77</span>
<span class="go">Date:                Tue, 18 Jul 2017   Prob (F-statistic):             0.0156</span>
<span class="go">Time:                        10:57:18   Log-Likelihood:                 14.907</span>
<span class="go">No. Observations:                   5   AIC:                            -25.81</span>
<span class="go">Df Residuals:                       3   BIC:                            -26.59</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const         -0.2522      0.038     -6.725      0.007      -0.372      -0.133</span>
<span class="go">x1            -0.1292      0.026     -4.977      0.016      -0.212      -0.047</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                          nan   Durbin-Watson:                   1.495</span>
<span class="go">Prob(Omnibus):                    nan   Jarque-Bera (JB):                0.757</span>
<span class="go">Skew:                           0.914   Prob(JB):                        0.685</span>
<span class="go">Kurtosis:                       2.464   Cond. No.                         19.3</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_scf_physroll.png" src="../../_images/design4_scf_physroll.png" />
<p>This example takes a bit longer to run than the others because, whenever a non-integer lag is used, the cube is shifted in Fourier space.</p>
<p>Throughout all of these examples, we have assumed that the spatial boundaries can be wrapped. This is appropriate for the example data since they are generated from a <a class="reference internal" href="../data_for_tutorials.html#data-for-tutorial"><span class="std std-ref">periodic-box simulation</span></a> and is the default setting (<code class="xref py py-obj docutils literal notranslate"><span class="pre">boundary='continuous'</span></code>). Typically this will not be the case for observational data. To avoid wrapping the edges of the data, <code class="xref py py-obj docutils literal notranslate"><span class="pre">boundary='cut'</span></code> can be set to avoid using the portion of the data that has been spatially wrapped:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span> <span class="o">=</span> <span class="n">SCF</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;cut&#39;</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">                            WLS Regression Results</span>
<span class="go">==============================================================================</span>
<span class="go">Dep. Variable:                      y   R-squared:                       0.993</span>
<span class="go">Model:                            WLS   Adj. R-squared:                  0.992</span>
<span class="go">Method:                 Least Squares   F-statistic:                     830.7</span>
<span class="go">Date:                Tue, 18 Jul 2017   Prob (F-statistic):           1.16e-07</span>
<span class="go">Time:                        11:13:18   Log-Likelihood:                 24.569</span>
<span class="go">No. Observations:                   8   AIC:                            -45.14</span>
<span class="go">Df Residuals:                       6   BIC:                            -44.98</span>
<span class="go">Df Model:                           1</span>
<span class="go">Covariance Type:            nonrobust</span>
<span class="go">==============================================================================</span>
<span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const         -0.0834      0.003    -31.106      0.000      -0.090      -0.077</span>
<span class="go">x1            -0.2425      0.008    -28.821      0.000      -0.263      -0.222</span>
<span class="go">==============================================================================</span>
<span class="go">Omnibus:                        0.723   Durbin-Watson:                   0.501</span>
<span class="go">Prob(Omnibus):                  0.697   Jarque-Bera (JB):                0.556</span>
<span class="go">Skew:                          -0.236   Prob(JB):                        0.757</span>
<span class="go">Kurtosis:                       1.797   Cond. No.                         3.38</span>
<span class="go">==============================================================================</span>
</pre></div>
</div>
<img alt="../../_images/design4_scf_boundcut.png" src="../../_images/design4_scf_boundcut.png" />
<p>This results in a steeper SCF slope as the edges of the rolled cubes are no longer used.</p>
<p>Computing the SCF can be computationally expensive for moderately-size data cubes. This is due to the need for shifting the entire cube along the spatial dimensions at each lag value. To avoid recomputing the SCF surface, the results of the SCF can be saved as a pickled object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">save_results</span><span class="p">(</span><span class="n">output_name</span><span class="o">=</span><span class="s2">&quot;Design4_SCF&quot;</span><span class="p">,</span> <span class="n">keep_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>Disabling <code class="xref py py-obj docutils literal notranslate"><span class="pre">keep_data</span></code> will remove the data cube before saving to save storage space.
Having saved the results, they can be reloaded using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span> <span class="o">=</span> <span class="n">SCF</span><span class="o">.</span><span class="n">load_results</span><span class="p">(</span><span class="s2">&quot;Design4_SCF.pkl&quot;</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>Note that if <code class="xref py py-obj docutils literal notranslate"><span class="pre">keep_data=False</span></code> was used when saving the file, the loaded version cannot be used to recalculate the SCF.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/1999ApJ...524..887R/abstract">Rosolowsky et al. 1999</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2001ApJ...547..862P/abstract">Padoan et al. 2001</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2003ApJ...588..881P/abstract">Padaon et al. 2003</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2004ApJ...616..845M/abstract">Muller et al. 2004</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2014ApJ...783...93Y/abstract">Yeremi et al. 2014</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2015ApJ...799..235G/abstract">Gaches et al. 2015</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, TurbuStat Development Team.<br/>
      Last updated on 13 Feb 2019.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>