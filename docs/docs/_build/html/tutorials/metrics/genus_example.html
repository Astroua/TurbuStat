<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Genus Distance &#8212; turbustat v1.0.dev2395</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MVC Distance" href="mvc_example.html" />
    <link rel="prev" title="Dendrogram Distance" href="dendro_example.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          turbustat</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.dev2395</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing TurbuStat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accepted_input_formats.html">Accepted Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preparing_simulated_data.html">Preparing Simulated Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_requirements.html">Data Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../moments.html">Deriving Cube Moments</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">TurbuStat Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generating_test_data.html">Creating testing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html#distance-metrics">Distance Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to TurbuStat</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Genus Distance</a><ul>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="dendro_example.html" title="Previous Chapter: Dendrogram Distance"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Dendrogram Distance</span>
    </a>
  </li>
  <li>
    <a href="mvc_example.html" title="Next Chapter: MVC Distance"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">MVC Distance &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/tutorials/metrics/genus_example.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Genus Distance</a><ul>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="genus-distance">
<span id="genusdist"></span><h1>Genus Distance<a class="headerlink" href="#genus-distance" title="Permalink to this headline">¶</a></h1>
<p>See <a class="reference internal" href="../statistics/genus_example.html#genus-tutorial"><span class="std std-ref">the tutorial</span></a> for a description of Genus statistics.</p>
<p>The distance metric for Genus is <a class="reference internal" href="../../api/turbustat.statistics.Genus_Distance.html#turbustat.statistics.Genus_Distance" title="turbustat.statistics.Genus_Distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Genus_Distance</span></code></a>. The distance between the Genus curves is defined as:</p>
<div class="math notranslate nohighlight">
\[d_{\mathrm{genus}} = \left|\left|\frac{G_{1}\left(I_{0,i}\right)}{A_1} - \frac{G_{2}\left(I_{0,i}\right)}{A_2}\right|\right|\]</div>
<p>where <span class="math notranslate nohighlight">\(G_{j}\left(I_{0, i}\right)\)</span> are the Genus curves, and <span class="math notranslate nohighlight">\(A_{j}\)</span> is the total area each Genus curve is measured over to normalize comparisons of images of different sizes.</p>
<p>More information on the distance metric definitions can be found in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2017MNRAS.471.1506K/abstract">Koch et al. 2017</a></p>
<div class="section" id="using">
<h2>Using<a class="headerlink" href="#using" title="Permalink to this headline">¶</a></h2>
<p><strong>The data in this tutorial are available</strong> <a class="reference external" href="https://girder.hub.yt/#user/57b31aee7b6f080001528c6d/folder/59721a30cc387500017dbe37">here</a>.</p>
<p>We need to import the <a class="reference internal" href="../../api/turbustat.statistics.Genus_Distance.html#turbustat.statistics.Genus_Distance" title="turbustat.statistics.Genus_Distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Genus_Distance</span></code></a> class, along with a few other common packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">turbustat.statistics</span> <span class="k">import</span> <span class="n">Genus</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>And we load in the two data sets; in this case, two integrated intensity (zeroth moment) maps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moment0</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Design4_flatrho_0021_00_radmc_moment0.fits&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moment0_fid</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Fiducial0_flatrho_0021_00_radmc_moment0.fits&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>The two images are passed to the <a class="reference internal" href="../../api/turbustat.statistics.Genus_Distance.html#turbustat.statistics.Genus_Distance" title="turbustat.statistics.Genus_Distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Genus_Distance</span></code></a> class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">genus</span> <span class="o">=</span> <span class="n">Genus_Distance</span><span class="p">(</span><span class="n">moment0_fid</span><span class="p">,</span> <span class="n">moment0</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">lowdens_percent</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">highdens_percent</span><span class="o">=</span><span class="mi">85</span><span class="p">,</span> <span class="n">numpts</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">genus_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">4</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p><a class="reference internal" href="../../api/turbustat.statistics.Genus_Distance.html#turbustat.statistics.Genus_Distance" title="turbustat.statistics.Genus_Distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Genus_Distance</span></code></a> accepts similar keyword arguments to <a class="reference internal" href="../../api/turbustat.statistics.Genus.html#turbustat.statistics.Genus" title="turbustat.statistics.Genus"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Genus</span></code></a>. Keywords to <a class="reference internal" href="../../api/turbustat.statistics.Genus.html#turbustat.statistics.Genus.run" title="turbustat.statistics.Genus.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> can be specified in a dictionary to <code class="xref py py-obj docutils literal notranslate"><span class="pre">genus_kwargs</span></code>. Separate keywords for the second image (<code class="xref py py-obj docutils literal notranslate"><span class="pre">moment0</span></code>) can be specified in a second dictionary to <code class="xref py py-obj docutils literal notranslate"><span class="pre">genus2_kwargs</span></code>.</p>
<p>To find the distance between the images:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">genus</span><span class="o">.</span><span class="n">distance_metric</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<img alt="../../_images/genus_distmet.png" src="../../_images/genus_distmet.png" />
<p>This returns a figure that plots the Genus curves of the two images, where the image values are standardized (zero mean and standard deviation of one). Colours, labels, and symbols in the plot can be changed. See <a class="reference internal" href="../../api/turbustat.statistics.Genus_Distance.html#turbustat.statistics.Genus_Distance.distance_metric" title="turbustat.statistics.Genus_Distance.distance_metric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distance_metric</span></code></a>.</p>
<p>When comparing many images to a fiducial image, a pre-computed <a class="reference internal" href="../../api/turbustat.statistics.Genus.html#turbustat.statistics.Genus" title="turbustat.statistics.Genus"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Genus</span></code></a> of the fiducial image can be passed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">turbustat.statistics</span> <span class="k">import</span> <span class="n">Genus</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genus_fid</span> <span class="o">=</span> <span class="n">Genus</span><span class="p">(</span><span class="n">moment0_fid</span><span class="p">,</span> <span class="n">lowdens_percent</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">highdens_percent</span><span class="o">=</span><span class="mi">85</span><span class="p">,</span> <span class="n">numpts</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genus_fid</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">4</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genus</span> <span class="o">=</span> <span class="n">Genus_Distance</span><span class="p">(</span><span class="n">moment0_fid</span><span class="p">,</span> <span class="n">moment0</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">lowdens_percent</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">highdens_percent</span><span class="o">=</span><span class="mi">85</span><span class="p">,</span> <span class="n">numpts</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">genus_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">min_size</span><span class="o">=</span><span class="mi">4</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="n">fiducial_model</span><span class="o">=</span><span class="n">genus_fid</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>Note that the data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">moment0_fid</span></code>) still need to be given.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2016ApJ...833..233B/abstract">Boyden et al. 2016</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2017MNRAS.471.1506K/abstract">Koch et al. 2017</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2018ApJ...860..157B/abstract">Boyden et al. 2018</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, TurbuStat Development Team.<br/>
      Last updated on 13 Feb 2019.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>