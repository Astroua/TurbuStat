<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Statistical Moments Distance &#8212; turbustat v1.0.dev2406</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="VCA Distance" href="vca_example.html" />
    <link rel="prev" title="SCF Distance" href="scf_example.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          turbustat</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.dev2406</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing TurbuStat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accepted_input_formats.html">Accepted Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preparing_simulated_data.html">Preparing Simulated Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_requirements.html">Data Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../moments.html">Deriving Cube Moments</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">TurbuStat Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generating_test_data.html">Creating testing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html#distance-metrics">Distance Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to TurbuStat</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Statistical Moments Distance</a><ul>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="scf_example.html" title="Previous Chapter: SCF Distance"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SCF Distance</span>
    </a>
  </li>
  <li>
    <a href="vca_example.html" title="Next Chapter: VCA Distance"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">VCA Distance &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/tutorials/metrics/statmoments_example.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Statistical Moments Distance</a><ul>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="statistical-moments-distance">
<span id="statmomentsdistmet"></span><h1>Statistical Moments Distance<a class="headerlink" href="#statistical-moments-distance" title="Permalink to this headline">¶</a></h1>
<p>See <a class="reference internal" href="../statistics/statmoments_example.html#statmoments-tutorial"><span class="std std-ref">the tutorial</span></a> for a description of the statistics moments.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">StatsMoments</span></code> calculates the first four moments—the mean, variance, skewness, and kurtosis—in circular regions of a map. For comparisons between different images, we utilize the skewness and kurtosis as metrics since they are not affected by offsets in the mean and are normalized by the variance. We reduce the moment images to histograms and define metrics from differences in the histograms. The histogram difference is converted to a distance by using the Hellinger distance:</p>
<div class="math notranslate nohighlight">
\[H(p_1,p_2) = \frac{1}{\sqrt{2}}\left\{\sum_{\tilde{I}} \left[ \sqrt{p_1(\tilde{I})} - \sqrt{p_{2}(\tilde{I})} \right]^2\right\}^{1/2}.\]</div>
<p>where <span class="math notranslate nohighlight">\(p_i\)</span> is the histogram of an image and <span class="math notranslate nohighlight">\(\tilde{I}\)</span> is the bin of the histogram. The same definition is used for the skewness and kurtosis.</p>
<p>More information on the distance metric definitions can be found in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2017MNRAS.471.1506K/abstract">Koch et al. 2017</a></p>
<div class="section" id="using">
<h2>Using<a class="headerlink" href="#using" title="Permalink to this headline">¶</a></h2>
<p><strong>The data in this tutorial are available</strong> <a class="reference external" href="https://girder.hub.yt/#user/57b31aee7b6f080001528c6d/folder/59721a30cc387500017dbe37">here</a>.</p>
<p>We need to import the <a class="reference internal" href="../../api/turbustat.statistics.StatMoments_Distance.html#turbustat.statistics.StatMoments_Distance" title="turbustat.statistics.StatMoments_Distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StatMoments_Distance</span></code></a> class, along with a few other common packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">turbustat.statistics</span> <span class="k">import</span> <span class="n">StatMoments_Distance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
</pre></div>
</div>
<p>And we load in the two data sets; in this case, two integrated intensity (zeroth moment) maps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moment0</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Design4_flatrho_0021_00_radmc_moment0.fits&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moment0_fid</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Fiducial0_flatrho_0021_00_radmc_moment0.fits&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>These images are given as inputs to <a class="reference internal" href="../../api/turbustat.statistics.StatMoments_Distance.html#turbustat.statistics.StatMoments_Distance" title="turbustat.statistics.StatMoments_Distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StatMoments_Distance</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span> <span class="o">=</span> <span class="n">StatMoments_Distance</span><span class="p">(</span><span class="n">moment0_fid</span><span class="p">,</span> <span class="n">moment0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">periodic1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">periodic2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>This runs <a class="reference internal" href="../../api/turbustat.statistics.StatMoments.html#turbustat.statistics.StatMoments" title="turbustat.statistics.StatMoments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StatMoments</span></code></a> for both images, which can be accessed with <code class="xref py py-obj docutils literal notranslate"><span class="pre">moments1</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">moments2</span></code>.</p>
<p>Since the moments are calculated in circular regions, it is important that the a common circular region be used for both images. <a class="reference internal" href="../../api/turbustat.statistics.StatMoments_Distance.html#turbustat.statistics.StatMoments_Distance" title="turbustat.statistics.StatMoments_Distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StatMoments_Distance</span></code></a> scales the given <code class="xref py py-obj docutils literal notranslate"><span class="pre">radius</span></code> to a common angular scale using the WCS information in the headers.</p>
<p>The boundary handling can also be changed by setting <code class="xref py py-obj docutils literal notranslate"><span class="pre">periodic1</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">periodic2</span></code> for the first and second images, respectively. By default, periodic boundaries are used, as is appropriated for simulated observations from a periodic-box (like this example). For real observations, periodic boundaries will likely need to be disabled.</p>
<p>To calculate the distance between the images:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span><span class="o">.</span><span class="n">distance_metric</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<img alt="../../_images/statmoments_distmet.png" src="../../_images/statmoments_distmet.png" />
<p>Additional arguments for the figure and the number of bins can also be given.  The default number of bins for the histogram is set to <span class="math notranslate nohighlight">\(\sqrt{{\rm min}(N_1, N_2)}\)</span> where <span class="math notranslate nohighlight">\(N_i\)</span> is the number of pixels in each image with a finite value.</p>
<p>The distances for the skewness and kurtosis are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">moments</span><span class="o">.</span><span class="n">skewness_distance</span><span class="p">,</span> <span class="n">moments</span><span class="o">.</span><span class="n">kurtosis_distance</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">0.01189910501201634 0.019870935761084074</span>
</pre></div>
</div>
<p>If many data sets are being compared to a fiducial, a pre-computed <a class="reference internal" href="../../api/turbustat.statistics.StatMoments.html#turbustat.statistics.StatMoments" title="turbustat.statistics.StatMoments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StatMoments</span></code></a> class can be passed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">turbustat.statistics</span> <span class="k">import</span> <span class="n">StatMoments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moments_fid</span> <span class="o">=</span> <span class="n">StatMoments</span><span class="p">(</span><span class="n">moment0_fid</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moments</span> <span class="o">=</span> <span class="n">StatMoments_Distance</span><span class="p">(</span><span class="n">moment0_fid</span><span class="p">,</span> <span class="n">moment0</span><span class="p">,</span> <span class="n">fiducial_model</span><span class="o">=</span><span class="n">moments_fid</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</pre></div>
</div>
<p>It is critical that the <code class="xref py py-obj docutils literal notranslate"><span class="pre">size</span></code> used in <a class="reference internal" href="../../api/turbustat.statistics.StatMoments.html#turbustat.statistics.StatMoments" title="turbustat.statistics.StatMoments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StatMoments</span></code></a> match the common set of lags that are used in <a class="reference internal" href="../../api/turbustat.statistics.StatMoments_Distance.html#turbustat.statistics.StatMoments_Distance" title="turbustat.statistics.StatMoments_Distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StatMoments_Distance</span></code></a>. Also note that the data still needs to be passed to <a class="reference internal" href="../../api/turbustat.statistics.StatMoments_Distance.html#turbustat.statistics.StatMoments_Distance" title="turbustat.statistics.StatMoments_Distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StatMoments_Distance</span></code></a>.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2016ApJ...833..233B/abstract">Boyden et al. 2016</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2017MNRAS.471.1506K/abstract">Koch et al. 2017</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2018ApJ...860..157B/abstract">Boyden et al. 2018</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, TurbuStat Development Team.<br/>
      Last updated on 14 Feb 2019.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>